# osmo.sessdsa

地空数算课2019期末作业

## 游戏概述
本游戏的原型为[Osmos](https://www.osmos-game.com/)，一个由Hemisphere Games开发的独立游戏，曾在2009年[独立游戏节](https://zh.wikipedia.org/独立游戏节)获得3个奖项的提名。原作支持多个平台，欢迎通过官方渠道购买/下载。

Osmo是受到到Osmos启发，而制作的一个简化版游戏框架。这里有一个部署在Heroku上的单机版本，可以在线体验：https://osmoss.herokuapp.com/ 。

下面介绍一些该游戏的典型规则和玩法，以及可能的设计思路。

### 游戏场地

游戏场地为矩形或圆形，游戏内基本单元为二维平面上的一些球（或者说，圆盘），称为“**星体**”。每个星体有一定**半径**，星体互不重叠且可以一定速度运动。

### 漂浮与边界

在没有外界影响的情况下，所有星体将做匀速直线运动，而当星体部分穿出游戏场地的边界时，穿出的部分将速度不变地移动至场地相对的一侧，或在边界处反弹。

### 接触与吸收

当两个星体相接触（即二者中心距离小于二者半径之和）时，半径较大的星体将“**吸收**”较小的星体，吸收过程保持“**质量**”守恒和“**动量**”守恒，其中认为星体的“质量”正比于星体面积。被完全吸收的星体将会从对局中移除。  
吸收的过程可以持续一段时间，按照一定的速率在两者间转移质量。

### 玩家

这个游戏可以具有一个或多个玩家（当然也可以是零玩家的，但作为一个经典物理世界，显得有些Trivial）。  
每个玩家将控制一个星体。如果由玩家控制的星体被完全吸收，则这名玩家失利。

### 发射

玩家控制的星体除遵守以上规则以外，还可主动将自身的部分质量作为一个新的星体发射出去。发射角度可由玩家自由控制。发射过程视为碰撞的逆过程，依然遵守“质量”和“动量”守恒。  
玩家可以利用在发射星体过程中的反作用来控制自身运动，进而不断吞噬比自身小的星体，并躲避比自己更大的星体。

### 获胜条件

根据规则的不同，获胜条件可以是在规定时间成为场地中最大星体，或吞噬目标星体（即一个或多个对手）。

### 其它想法

在现有的物理引擎下，还可以开发出带有负质量或处于引力场中的对战模式。

## 规则介绍
本次大作业的内容是编写一个AI函数，来进行Osmo游戏，并取得胜利。为了保证比赛公平性，并适当控制AI编写难度（亦可以使人类玩家获得更好的游戏体验），大作业所采用的规则，基于前述的设计思路进行了定量规定和修改。  
大作业采用的是双玩家对战。AI要做的事情，就是使之作为“玩家”做出决策控制自身星体，不断成长并吞噬由另一个AI操控的星体。自身星体先被吞噬者判为失败。

### 场地限制与初始条件

场地为`500x1000`的矩形。游戏开始时，两玩家星体分别位于坐标`(250, 250)`与`(250, 750)`处，初始半径均为`%d`，初始速度静止。  
初始状态下，场地中除了玩家星体外还将随机分布`%d`个星体，其半径范围`%d`，初始速度范围`%d`。

### 边界穿越

当星体运动至边界时，将速度不变穿越至相对的一侧边界。

### 星体编号

对局开始时，随机确定一名“**主玩家**”，使其获得编号0，另一位玩家编号为1。随机分布的星体获得递增的编号。在星体被完全吸收后，删除其编号并不再使用；每次在发射产生新的星体后，使其获得一个新的编号。  
换句话说，两玩家星体编号分别为0、1，编号2及以后为非玩家星体。

### 吸收判定

当两星体接触时，按以下规则判定何者被吸收：
- 当二者半径不等时，半径较小者被吸收。
- 当二者半径在误差范围（根据Python使用的IEEE-754浮点数精度）内相等，速度较大者被吸收。
- 当二者半径和速度在误差内均相等（这……），星体编号较小者被吸收。

当一个星体同时与多个星体接触，或多个星体同时相互接触（“**同时**”指一个运算帧内）时，按以下规则处理：
- 由星体编号最小的星体开始判断，若此时与其接触的星体中有半径大于此星体的，则此星体被吸收。之后星体的判断中视为此星体已不存在。
- 若一个星体同时被多个星体吸收，则按以下规则判定被何者吸收：
  1. 当各吸收星体中半径最大者唯一，则被半径最大者吸收。
  2. 当各吸收星体中半径最大者不唯一，则被速度最小者吸收。
  3. 当各吸收星体中半径最大且速度最小者不唯一，则被星体编号较小者吸收。

若一次吸收发生后又产生了新的接触情况，则新的接触情况在下一帧处理（可能下一帧已脱离接触，则不再处理）。

### 发射

玩家每一帧中最多可发射1次星体，发射星体半径为一恒定值`Δr`（当自身半径小于等于`Δr`时不可发射），相对自身速度为恒定值`Δv`，发射角度可为`[0, 360)`内的任意浮点数。

## 输入输出要求
编写函数`play(stellar_list)`，输入为一个`list`，为当前的所有星体（包括玩家星体），下标为前述的星体编号。  
每个星体数据为一个`tuple`，形如`(pos, v, r)`，其中`pos=(x, y)`，`v=(v_x, v_y)`。  
`x, y, v_x, v_y, r`分别代表星体的x坐标，y坐标，x速度分量，y速度分量，半径，均为浮点数。  
要求返回一个值即发射角度`a`，要求`0≤a＜360`。若不发射，返回`-1`.

## 时间空间限制

## 备注
